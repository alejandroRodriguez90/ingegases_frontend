<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard</title>
    <link rel="stylesheet" href="user.css"> 
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script> <!-- Librería Chart.js para gráficas -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.3/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"><!-- Iconos de FontAwesome -->
    
</head>

<body>
    <!-- Barra superior -->
    <div class="top-bar">
        <div class="logo"><!-- Logo o foto de usuario -->
            <img src="imagenes /PHOTO-2025-01-22-08-45-11.jpg" alt="">
        </div>
        <div class="logout">   <!-- Botón de cerrar sesión -->
            <button onclick="window.location.href='../login/login.html'">Cerrar sesión</button>
        </div>
    </div>
    <div class="sidebar"><!-- Barra lateral vertical -->
        <ul>
            <li>
                <a href="#" id="controlInventarioLink">
                    <i class="fas fa-boxes icon"></i>
                    <span class="text">Control de Inventario</span>
                </a>
                    <ul class="submenu">
                        <li>
                            <a href="#" onclick="loadTuberia()">
                                <i class="fas fa-wrench icon"></i>
                                <span class="text">Tubería</span>
                            </a>
                        </li>
                        <li>
                            <a href="#" onclick="loadAccesorios()">
                                <i class="fas fa-tools icon"></i>
                                <span class="text">Accesorios</span>
                            </a>
                        </li>
                    </ul>
                </a>
            </li>
            <li>
                <a href="#" id="proyectosLink">
                    <i class="fas fa-project-diagram icon"></i>
                    <span class="text">Proyecto</span>
                </a>
            </li>
            <li>
                <a href="#" id="requisicionLink">
                    <i class="fas fa-file-alt icon"></i>
                    <span class="text">Requisición</span>
                </a>
            </li>
            <li>
                <a href="#" id="proveedoresLink">
                    <i class="fas fa-truck icon"></i>
                    <span class="text">Proveedores</span>
                </a>
            </li>
            <li>
                <a href="#" id="almacenLink">
                    <i class="fas fa-warehouse icon"></i>
                    <span class="text">Almacén</span>
                </a>
            </li>
            <li>
                <a href="#" id="soporteLink">
                    <i class="fas fa-headset icon"></i>
                    <span class="text">Soporte</span>
                </a>
            </li>
        </ul>
    </div>

    
    <!-- Contenido principal -->
    <div class="main-content">
        <h1>Ingegases Y Redes s.a.s</h1>
        <div id="dynamicContent"></div><!-- Contenedor para contenido dinámico -->
    </div>

    
    <!-- Ventana modal PROYECTOS -->
    <div id="projectModal" class="modal">
        <div class="modal-content">
            <span class="close">×</span>
            <h2 id="modalTitle">Título del Proyecto</h2> <!-- Título dinámico -->
            <form id="projectForm">
                <!-- Campos del formulario -->
                <label for="projectId">ID:</label>
                <input type="text" id="projectId" name="projectId" required>

                <label for="projectName">Proyecto:</label>
                <input type="text" id="projectName" name="projectName" required>

                <label for="projectDescription">Descripción:</label>
                <textarea id="projectDescription" name="projectDescription" required></textarea>

                <label for="projectLocation">Ubicación:</label>
                <input type="text" id="projectLocation" name="projectLocation" required>

                <label for="projectStartDate">Fecha de Inicio:</label>
                <input type="date" id="projectStartDate" name="projectStartDate" required>

                <label for="projectEndDate">Fecha de Fin:</label>
                <input type="date" id="projectEndDate" name="projectEndDate" required>

                <label for="projectManager">Encargado:</label>
                <select id="projectManager" name="projectManager" required>
                    <option value="Ing Alexander Herrera">Ing Alexander Herrera</option>
                    <option value="Ing Javier Sierra">Ing Javier Sierra</option>
                    <option value="Ing Daniel Buitrago">Ing Daniel Buitrago</option>
                    <option value="Ing Javier Penagos">Ing Javier Penagos</option>
                    <option value="Ing Nicolás Saavedra">Ing Nicolás Saavedra</option>
                    <option value="Ing Jenny Chaparro">Ing Jenny Chaparro</option>
                    <option value="Ing Melissa Gonzalez">Ing Melissa Gonzalez</option>
                </select>

                <label for="projectStatus">Estado:</label>
                <select id="projectStatus" name="projectStatus" required>
                    <option value="Asignado">Asignado</option>
                    <option value="En Ejecución">En Ejecución</option>
                    <option value="Realizado">Realizado</option>
                    <option value="Facturado">Facturado</option>
                    <option value="Anulado">Anulado</option>
                </select>

                <label for="projectBudget">Presupuesto:</label>
                <input type="text" id="projectBudget" name="projectBudget" required>

                <button type="submit" id="saveButton">Guardar</button>
            </form>
        </div>
    </div>

    <!-- Ventana modal de confirmación para eliminar un proyecto -->
    <div id="confirmModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>¿Realmente quieres eliminar el proyecto?</h2>
            <button id="confirmDelete">Sí</button>
            <button id="cancelDelete">No</button>
        </div>
    </div>


    <!-- Contenido dinámico ALMACEN-->
    <div id="dynamicContent" class="alm-content-container"></div>

    <!-- Modal de Almacén -->
    <div class="alm-modal-container" id="almacenModal">
    <div class="alm-modal-overlay" onclick="closeAlmModal('almacenModal')"></div>
    <div class="alm-modal-dialog alm-modal-lg">
        <div class="alm-modal-content">
        <div class="alm-modal-header">
            <h2 class="alm-modal-title">Detalles del Almacén</h2>
            <button class="alm-modal-close" onclick="closeAlmModal('almacenModal')">
            <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="alm-modal-body" id="almacenModalBody"></div>
        <div class="alm-modal-footer">
            <button class="alm-btn alm-btn-secondary" onclick="closeAlmModal('almacenModal')">
            <i class="fas fa-times"></i> Cerrar
            </button>
            <button class="alm-btn alm-btn-primary" onclick="exportarInventario()">
            <i class="fas fa-file-export"></i> Exportar
            </button>
        </div>
        </div>
    </div>
    </div>

    <!-- Modal para Agregar Producto -->
    <div class="alm-modal-container" id="agregarProductoModal">
    <div class="alm-modal-overlay" onclick="closeAlmModal('agregarProductoModal')"></div>
    <div class="alm-modal-dialog">
        <div class="alm-modal-content">
        <div class="alm-modal-header">
            <h2 class="alm-modal-title">Agregar Producto</h2>
            <button class="alm-modal-close" onclick="closeAlmModal('agregarProductoModal')">
            <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="alm-modal-body">
            <form id="alm-productoForm" class="alm-form-grid">
            <!-- Campos del formulario se generarán dinámicamente -->
            </form>
        </div>
        <div class="alm-modal-footer">
            <button class="alm-btn alm-btn-secondary" onclick="closeAlmModal('agregarProductoModal')">
            <i class="fas fa-times"></i> Cancelar
            </button>
            <button class="alm-btn alm-btn-primary" onclick="guardarNuevoProducto()">
            <i class="fas fa-save"></i> Guardar
            </button>
        </div>
        </div>
    </div>
    </div>

    <script>
            

        // ---------------------------------------------------------------------------
        // Configuracion de tuberia
        // ---------------------------------------------------------------------------
        const materialOptions = {
            "Cobre": { tipos: ["M", "K", "L"], diametros: ["1/8", "1/4", "3/8", "1/2", "3/4", "1", "1-1/4", "1-1/2", "3", "3-1/2", "4"] },
            "Acero inoxidable": { tipos: ["10", "40", "80"], diametros: ["1/8", "1/4", "3/8", "1/2", "3/4", "1", "1-1/4", "1-1/2", "3", "3-1/2", "4"] },
            "Acero carbono": { tipos: ["10", "40", "80"], diametros: ["1/8", "1/4", "3/8", "1/2", "3/4", "1", "1-1/4", "1-1/2", "3", "3-1/2", "4"] },
            "PVC": { tipos: ["Presion", "Electrica", "Sanitaria", "Ventilacion"], diametros: ["1/8", "1/4", "3/8", "1/2", "3/4", "1", "1-1/4", "1-1/2", "3", "3-1/2", "4"] }
        };

        // Generar mapeo de descripciones a códigos
        let codigoCounter = 1;
        const descripcionToCodigo = {};
        const descripcionesDisponibles = [];
        for (const material in materialOptions) {
            const tipos = materialOptions[material].tipos;
            const materialSinEspacios = material.replace(/\s+/g, '');
        
            for (const tipo of tipos) {
                // Formatear el tipo según las reglas:
                let tipoFormateado = tipo;
                if (["M", "K", "L"].includes(tipo)) {
                    tipoFormateado = `Tipo${tipo}`;  // Ej: TipoM, TipoK, TipoL
                } else if (["10", "40", "80"].includes(tipo)) {
                    tipoFormateado = `Sch${tipo}`;   // Ej: Sch10, Sch40, Sch80
                }
                // Los demás tipos (ej: "Presión") se quedan igual
        
                for (const diametro of materialOptions[material].diametros) {
                    const descripcion = `Tubería${materialSinEspacios}${tipoFormateado}${diametro}`;
                    const codigo = "IYR" + codigoCounter.toString().padStart(4, '0');
        
                    descripcionToCodigo[descripcion] = codigo;
                    descripcionesDisponibles.push(descripcion);
                    codigoCounter++;
                }
            }
        }


        // Variable para almacenar el item actual
        let itemActual = null;
        let chart;

        // ---------------------------------------------------------------------------
        // Funciones principales
        // ---------------------------------------------------------------------------
        function loadTuberia() {
            const tableContent = `
                <div class="section-title vertical-title">Tubería</div>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Código</th>
                                <th>Descripción</th>
                                <th>Ubicación</th>
                                <th>Cantidad</th>
                                <th>Valor</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${generarFilaConsulta()}
                        </tbody>
                    </table>
                    <div class="export-button-container">
                        <button id="btnExportar">Exportar a Excel</button>
                    </div>
                </div>
                <div class="chart-container">
                    <h3>Gráfica de Consulta</h3>
                    <canvas id="tuberiaChart"></canvas>
                </div>
            `;

            document.getElementById('dynamicContent').innerHTML = tableContent;

            // Configurar eventos
            configurarEventos();
            
            // Inicializar gráfica (oculta al inicio)
            document.getElementById('tuberiaChart').style.display = 'none';
        }

        function generarFilaConsulta() {
            return `
                <tr class="fila-consulta">
                    <td id="codigoGenerado"></td>
                    <td>
                        <input type="text" id="inputDescripcion" 
                            placeholder="Buscar tubería..." 
                            list="listaTuberias" autocomplete="off">
                        <datalist id="listaTuberias">
                            ${descripcionesDisponibles.map(desc => 
                                `<option value="${desc}">${desc}</option>`).join('')}
                        </datalist>
                    </td>
                    <td><input type="text" id="inputUbicacion" placeholder="Ubicación" value="Bogotá"></td>
                    <td id="cantidadCell"><input type="number" id="inputCantidad" placeholder="Cantidad" min="0" value="0" onchange="actualizarEstadoStock()"></td>
                    <td><input type="number" id="inputValor" placeholder="Valor" min="0" step="0.01"></td>
                </tr>
            `;
        }

        function actualizarEstadoStock() {
            const cantidadInput = document.getElementById('inputCantidad');
            const cantidadCell = document.getElementById('cantidadCell');
            const valor = parseFloat(cantidadInput.value) || 0;
            
            if (valor === 0) {
                cantidadCell.innerHTML = `
                    <span class="no-stock" onclick="restaurarInputCantidad()">No Stock</span>
                    <input type="number" id="inputCantidad" value="0" min="0" style="display:none;">
                `;
            } else {
                cantidadCell.innerHTML = `<input type="number" id="inputCantidad" placeholder="Cantidad" min="0" value="${valor}" onchange="actualizarEstadoStock()">`;
            }
            
            // Actualizar el objeto itemActual si existe
            if (itemActual) {
                itemActual.cantidad = valor;
                actualizarGrafica();
            }
        }

        function restaurarInputCantidad() {
            const cantidadCell = document.getElementById('cantidadCell');
            cantidadCell.innerHTML = `<input type="number" id="inputCantidad" placeholder="Cantidad" min="0" value="0" onchange="actualizarEstadoStock()">`;
            document.getElementById('inputCantidad').focus();
        }


        function configurarEventos() {
            const inputDesc = document.getElementById('inputDescripcion');
            
            inputDesc.addEventListener('input', function() {
                // Restaurar el input de cantidad al cambiar descripción
                const cantidadCell = document.getElementById('cantidadCell');
                cantidadCell.innerHTML = `<input type="number" id="inputCantidad" placeholder="Cantidad" min="0" value="0" onchange="actualizarEstadoStock()">`;
                
                const descripcion = this.value;
                const codigo = descripcionToCodigo[descripcion];
                document.getElementById('codigoGenerado').textContent = codigo || '';
                
                if (codigo) {
                    itemActual = {
                        codigo: codigo,
                        descripcion: descripcion,
                        ubicacion: document.getElementById('inputUbicacion').value || 'Bogotá',
                        cantidad: 0, // Iniciar en 0
                        valor: parseFloat(document.getElementById('inputValor').value) || 0
                    };
                    actualizarGrafica();
                }
            });
    
            // Actualizar datos cuando cambian otros campos
            ['inputUbicacion', 'inputValor'].forEach(id => {
                document.getElementById(id).addEventListener('change', function() {
                    if (itemActual) {
                        itemActual.ubicacion = document.getElementById('inputUbicacion').value;
                        itemActual.valor = parseFloat(document.getElementById('inputValor').value) || 0;
                        actualizarGrafica();
                    }
                });
            });
            
            // Configurar botón de exportar
            document.getElementById('btnExportar').addEventListener('click', exportarAExcel);
            
            // Verificar estado inicial del stock
            actualizarEstadoStock();
        }

        function actualizarGrafica() {
            if (!itemActual) {
                document.getElementById('tuberiaChart').style.display = 'none';
                return;
            }
            
            const ctx = document.getElementById('tuberiaChart').getContext('2d');
            ctx.canvas.style.display = 'block';
            
            // Asegurar que el canvas tenga el tamaño correcto
            ctx.canvas.width = ctx.canvas.offsetWidth;
            ctx.canvas.height = 300; // Altura fija
            
            if (chart) {
                chart.destroy();
            }
            
            chart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: [itemActual.descripcion],
                    datasets: [{
                        label: 'Cantidad',
                        data: [itemActual.cantidad],
                        backgroundColor: 'rgba(54, 162, 235, 0.7)',
                        borderColor: 'rgba(54, 162, 235, 1)',
                        borderWidth: 1
                    }]
                },
                options: {
                    indexAxis: 'y',
                    responsive: true,
                    maintainAspectRatio: false, // Desactivar relación de aspecto fija
                    scales: {
                        x: { 
                            beginAtZero: true,
                            ticks: {
                                precision: 0 // Mostrar números enteros
                            }
                        },
                        y: { 
                            ticks: { 
                                autoSkip: false,
                                font: {
                                    size: 12 // Tamaño de fuente más pequeño
                                }
                            } 
                        }
                    },
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            callbacks: {
                                afterLabel: () => {
                                    return `Código: ${itemActual.codigo}\nValor: $${itemActual.valor.toFixed(2)}`;
                                }
                            }
                        }
                    },
                    layout: {
                        padding: {
                            top: 10,
                            right: 10,
                            bottom: 10,
                            left: 10
                        }
                    }
                }
            });
        }

        function exportarAExcel() {
            if (!itemActual) {
                alert("No hay datos para exportar");
                return;
            }
            
            // Obtener el valor de cantidad (puede estar oculto como "No Stock")
            const cantidadInput = document.getElementById('inputCantidad');
            const cantidad = parseFloat(cantidadInput.value) || 0;
            
            // Crear un objeto con los datos a exportar
            const datos = [{
                'Código': itemActual.codigo,
                'Descripción': itemActual.descripcion,
                'Ubicación': itemActual.ubicacion || 'Bogotá', // Bogotá por defecto
                'Cantidad': cantidad === 0 ? 'No Stock' : cantidad, // Mostrar "No Stock" si es 0
                'Valor': itemActual.valor
                            
                }
            ];
            
            // Convertir a CSV
            const csvRows = [];
            const headers = Object.keys(datos[0]);
            csvRows.push(headers.join(','));
            
            for (const row of datos) {
                const values = headers.map(header => {
                    const escaped = ('' + row[header]).replace(/"/g, '\\"');
                    return `"${escaped}"`;
                });
                csvRows.push(values.join(','));
            }
            
            const csvString = csvRows.join('\n');
            const blob = new Blob([csvString], { type: 'text/csv;charset=utf-8;' });
            const url = URL.createObjectURL(blob);
            
            // Crear enlace de descarga
            const link = document.createElement('a');
            link.setAttribute('href', url);
            link.setAttribute('download', `tuberia_${itemActual.codigo}.csv`);
            link.style.visibility = 'hidden';
            
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        // Inicializar al cargar
        document.addEventListener('DOMContentLoaded', loadTuberia);

        // ---------------------------------------------------------------------------
        // Creacion Accesorios
        // ---------------------------------------------------------------------------

        const materialOptionsAccesorios = {
            "Cobre": {
                tipos: ["Union", "Tee", "Tee Red Central", "Tee Red Lateral", "Codo", "Semicodo", "Copa Reduccion", "Universales", "Tapon", "Adaptador"],
                clases: ["M", "K", "L"],
                diametros: ["1/8", "1/4", "3/8", "1/2", "3/4", "1", "1-1/4", "1-1/2", "3", "3-1/2", "4", "N/A"],
                conexiones: ["Soldeo", "NPTH", "NPTM", "N/A"],
                c_entradas: ["NPTH", "NPTM", "BSPM", "BSPH", "DISS", "DIM", "CGA", "OD", "Soldeo", "N/A"],
                c_salidas: ["NPTH", "NPTM", "BSPM", "BSPH", "DISS", "DIM", "CGA", "OD", "Soldeo", "N/A"]
            },
            "Acero Inoxidable": {
                tipos: ["Union", "Tee", "Tee Red Central", "Tee Red Lateral", "Codo", "Semicodo", "Copa Reduccion", "Universales", "Tapon", "Adaptador", "Bushing", "Brida"],
                clases: ["10", "40", "80"], // Clases base. Se agregará 150psi, 300psi, 3000psi para brida.
                diametros: ["1/8", "1/4", "3/8", "1/2", "3/4", "1", "1-1/4", "1-1/2", "3", "3-1/2", "4", "N/A"],
                conexiones: ["Soldeo", "NPTH", "NPTM", "N/A", "Socket"],
                c_entradas: ["NPTH", "NPTM", "BSPM", "BSPH", "DISS", "DIM", "CGA", "OD", "Soldeo", "N/A", "Socket"],
                c_salidas: ["NPTH", "NPTM", "BSPM", "BSPH", "DISS", "DIM", "CGA", "OD", "Soldeo", "N/A", "Socket"]
            },
            "Acero Carbon": {
                tipos: ["Union", "Tee", "Tee Red Central", "Tee Red Lateral", "Codo", "Semicodo", "Copa Reduccion", "Universales", "Tapon", "Adaptador", "Brida", "Bushing"],
                clases: ["10", "40", "80"], // Clases base. Se agregará 150psi, 300psi, 3000psi para brida.
                diametros: ["1/8", "1/4", "3/8", "1/2", "3/4", "1", "1-1/4", "1-1/2", "3", "3-1/2", "4", "N/A"],
                conexiones: ["Soldeo", "NPTH", "NPTM", "N/A", "Socket"],
                c_entradas: ["NPTH", "NPTM", "BSPM", "BSPH", "DISS", "DIM", "CGA", "OD", "Soldeo", "N/A", "Socket"],
                c_salidas: ["NPTH", "NPTM", "BSPM", "BSPH", "DISS", "DIM", "CGA", "OD", "Soldeo", "N/A", "Socket"]
            },
            "Bronce": {
                tipos: ["Union", "Tee", "Tee Red Central", "Tee Red Lateral", "Codo", "Semicodo", "Copa Reduccion", "Universales", "Tapon", "Adaptador", "Bushing", "Brida"],
                clases: [], // No tiene clases, se agregarán para brida.
                diametros: ["1/8", "1/4", "3/8", "1/2", "3/4", "1", "1-1/4", "1-1/2", "3", "3-1/2", "4", "N/A"],
                conexiones: ["Soldeo", "NPTH", "NPTM"],
                c_entradas: ["H-M", "H-K", "H-L", "M-M", "M-K", "M-L", "H-10", "H-40", "H-80", "M-10", "M-40", "M-80", "NPTH", "NPTM", "BSPM", "BSPH", "DISS", "DIM", "CGA", "OD", "Soldeo", "N/A"],
                c_salidas: ["H-M", "H-K", "H-L", "M-M", "M-K", "M-L", "H-10", "H-40", "H-80", "M-10", "M-40", "M-80", "NPTH", "NPTM", "BSPM", "BSPH", "DISS", "DIM", "CGA", "OD", "Soldeo", "N/A"]
            },
            "PVC": {
                tipos: ["Union", "Tee", "Tee Red Central", "Tee Red Lateral", "Codo", "Semicodo", "Copa Reduccion", "Universales", "Tapon", "Adaptador"],
                clases: ["Presion", "Electrica", "Sanitaria", "Ventilacion"],
                diametros: ["1/8", "1/4", "3/8", "1/2", "3/4", "1", "1-1/4", "1-1/2", "3", "3-1/2", "4", "N/A"],
                conexiones: ["Lisa", "NPTH", "NPTM", "N/A"],
                c_entradas: ["Lisa", "NPTH", "NPTM", "N/A"],
                c_salidas: ["Lisa", "NPTH", "NPTM", "N/A"]
            }
        };

        const accesoriosData = [
            {
                material: "Cobre", tipo: "Union", clase: "M", diametro: "1/2", d_entrada: "1/2", d_salida: "1/2", conexion: "Soldeo", c_entrada: "Soldeo", c_salida: "Soldeo", cantidad: 2, valor: 5
            },
            {
                material: "Acero Inoxidable", tipo: "Union", clase: "10", diametro: "1/2", d_entrada: "1/2", d_salida: "1/2", conexion: "Soldeo", c_entrada: "Soldeo", c_salida: "Soldeo", cantidad: 3, valor: 8
            },
            {
                material: "Acero Carbon", tipo: "Union", clase: "10", diametro: "1/2", d_entrada: "1/2", d_salida: "1/2", conexion: "Soldeo", c_entrada: "Soldeo", c_salida: "Soldeo", cantidad: 1, valor: 12
            },
            {
                material: "Bronce", tipo: "Union", clase: "", diametro: "1/2", d_entrada: "1/2", d_salida: "1/2", conexion: "Soldeo", c_entrada: "Soldeo", c_salida: "Soldeo", cantidad: 4, valor: 3
            },
            {
                material: "PVC", tipo: "Union", clase: "Presion", diametro: "1/2", d_entrada: "1/2", d_salida: "1/2", conexion: "Lisa", c_entrada: "Lisa", c_salida: "Lisa", cantidad: 2, valor: 2
            }
        ];
        let chartAccesorios; // Variable global para almacenar la instancia de la gráfica de accesorios

        function loadAccesorios() {
            const tableHeaders = `
                <tr>
                    <th>Código</th>
                    <th>Material</th>
                    <th>Tipo</th>
                    <th>Clase</th>
                    <th>Diámetro</th>
                    <th>D_Entrada</th>
                    <th>D_Salida</th>
                    <th>Conexión</th>
                    <th>C_Entrada</th>
                    <th>C_Salida</th>
                    <th>Cantidad</th>
                    <th>Valor</th>
                </tr>
            `;

            const tableRows = accesoriosData.map((item, index) => {
                const tipos = materialOptionsAccesorios[item.material].tipos;
                let clases = materialOptionsAccesorios[item.material].clases;
                const diametros = materialOptionsAccesorios[item.material].diametros;
                const conexiones = materialOptionsAccesorios[item.material].conexiones;
                const c_entradas = materialOptionsAccesorios[item.material].c_entradas;
                const c_salidas = materialOptionsAccesorios[item.material].c_salidas;

                // Lógica para las clases de Brida (Acero Inoxidable, Acero Carbon, Bronce)
                if (item.tipo === "Brida" && (item.material === "Acero Inoxidable" || item.material === "Acero Carbon" || item.material === "Bronce")) {
                    clases = ["150psi", "300psi", "3000psi"];
                } else if (item.material === "Bronce") {
                    clases = []; // Limpiar clases para Bronce si no es Brida
                }

                return `
                    <tr>
                        <td></td>
                        <td>${item.material}</td>
                        <td>
                            <select class="tipo-select-acc" data-index="${index}">
                                ${tipos.map(tipo => `<option value="${tipo}" ${tipo === item.tipo ? 'selected' : ''}>${tipo}</option>`).join('')}
                            </select>
                        </td>
                        <td>
                            <select class="clase-select-acc" data-index="${index}" ${item.tipo === "Brida" || item.material === "Bronce" ? '' : ''}>
                                ${clases.map(clase => `<option value="${clase}" ${clase === item.clase ? 'selected' : ''}>${clase}</option>`).join('')}
                            </select>
                        </td>
                        <td>
                            <select class="diametro-select-acc" data-index="${index}">
                                ${diametros.map(diametro => `<option value="${diametro}" ${diametro === item.diametro ? 'selected' : ''}>${diametro}</option>`).join('')}
                            </select>
                        </td>
                        <td>
                            <select class="d-entrada-select-acc" data-index="${index}">
                                ${diametros.map(diametro => `<option value="${diametro}" ${diametro === item.d_entrada ? 'selected' : ''}>${diametro}</option>`).join('')}
                            </select>
                        </td>
                        <td>
                            <select class="d-salida-select-acc" data-index="${index}">
                                ${diametros.map(diametro => `<option value="${diametro}" ${diametro === item.d_salida ? 'selected' : ''}>${diametro}</option>`).join('')}
                            </select>
                        </td>
                        <td>
                            <select class="conexion-select-acc" data-index="${index}">
                                ${conexiones.map(conexion => `<option value="${conexion}" ${conexion === item.conexion ? 'selected' : ''}>${conexion}</option>`).join('')}
                            </select>
                        </td>
                        <td>
                            <select class="c-entrada-select-acc" data-index="${index}">
                                ${c_entradas.map(c_entrada => `<option value="${c_entrada}" ${c_entrada === item.c_entrada ? 'selected' : ''}>${c_entrada}</option>`).join('')}
                            </select>
                        </td>
                        <td>
                            <select class="c-salida-select-acc" data-index="${index}">
                                ${c_salidas.map(c_salida => `<option value="${c_salida}" ${c_salida === item.c_salida ? 'selected' : ''}>${c_salida}</option>`).join('')}
                            </select>
                        </td>
                        <td>
                            <input type="number" class="cantidad-input-acc" data-index="${index}" value="${item.cantidad}" />
                        </td>
                        <td>
                        <span class="valor">$${item.valor}</span>
                        </td>
                    </tr>
                `;
            }).join('');

            const tableContent = `
                <div class="section-title vertical-title">Accesorios</div>
                <div class="table-container">
                    <table>
                        <thead>${tableHeaders}</thead>
                        <tbody>${tableRows}</tbody>
                    </table>
                </div>
            `;
            const chartContent = `
                <h3>Gráfica de Cantidades (Accesorios)</h3>
                <canvas id="accesoriosChart"></canvas>
            `;

            const fullContent = tableContent + chartContent; // Unir la tabla y la gráfica en un solo bloque

            document.getElementById('dynamicContent').innerHTML = fullContent; // Asignar el contenido completo

            createChartAccesorios(); // Crea la gráfica después de cargar la tabla.
            updateChartAccesorios(); // Actualiza la gráfica con los datos iniciales

            // --- Event Listeners Accesorios ---
            document.querySelectorAll('.tipo-select-acc').forEach(select => {
                select.addEventListener('change', (event) => {
                    const index = parseInt(event.target.getAttribute('data-index'));
                    accesoriosData[index].tipo = event.target.value;

                    // Actualizar las clases si el tipo es Brida
                    if (accesoriosData[index].tipo === "Brida" && (accesoriosData[index].material === "Acero Inoxidable" || accesoriosData[index].material === "Acero Carbon" || accesoriosData[index].material === "Bronce")) {
                        accesoriosData[index].clase = "150psi"; // Reset clase
                        loadAccesorios(); // Recargar tabla para mostrar las clases correctas
                    }
                    //inhabilitar clase en bronce
                    else if (accesoriosData[index].material === "Bronce") {
                        accesoriosData[index].clase = "";
                        loadAccesorios(); // Recargar tabla para mostrar las clases correctas
                    }
                    updateChartAccesorios() //actulizar grafica
                });
            });

            document.querySelectorAll('.clase-select-acc').forEach(select => {
                select.addEventListener('change', (event) => {
                    const index = parseInt(event.target.getAttribute('data-index'));
                    accesoriosData[index].clase = event.target.value;
                    updateChartAccesorios() //actulizar grafica
                });
            });

            document.querySelectorAll('.diametro-select-acc').forEach(select => {
                select.addEventListener('change', (event) => {
                    const index = parseInt(event.target.getAttribute('data-index'));
                    accesoriosData[index].diametro = event.target.value;
                    updateChartAccesorios() //actulizar grafica
                });
            });

            document.querySelectorAll('.d-entrada-select-acc').forEach(select => {
                select.addEventListener('change', (event) => {
                    const index = parseInt(event.target.getAttribute('data-index'));
                    accesoriosData[index].d_entrada = event.target.value;
                    updateChartAccesorios() //actulizar grafica
                });
            });

            document.querySelectorAll('.d-salida-select-acc').forEach(select => {
                select.addEventListener('change', (event) => {
                    const index = parseInt(event.target.getAttribute('data-index'));
                    accesoriosData[index].d_salida = event.target.value;
                    updateChartAccesorios() //actulizar grafica
                });
            });

            document.querySelectorAll('.conexion-select-acc').forEach(select => {
                select.addEventListener('change', (event) => {
                    const index = parseInt(event.target.getAttribute('data-index'));
                    accesoriosData[index].conexion = event.target.value;
                    updateChartAccesorios() //actulizar grafica
                });
            });

            document.querySelectorAll('.c-entrada-select-acc').forEach(select => {
                select.addEventListener('change', (event) => {
                    const index = parseInt(event.target.getAttribute('data-index'));
                    accesoriosData[index].c_entrada = event.target.value;
                    updateChartAccesorios() //actulizar grafica
                });
            });

            document.querySelectorAll('.c-salida-select-acc').forEach(select => {
                select.addEventListener('change', (event) => {
                    const index = parseInt(event.target.getAttribute('data-index'));
                    accesoriosData[index].c_salida = event.target.value;
                    updateChartAccesorios() //actulizar grafica
                });
            });

            document.querySelectorAll('.cantidad-input-acc').forEach(input => {
                input.addEventListener('change', (event) => {
                    const index = parseInt(event.target.getAttribute('data-index'));
                    accesoriosData[index].cantidad = parseInt(event.target.value);
                    updateChartAccesorios();
                });
            });
        }

        function createChartAccesorios() {
            const ctxAccesorios = document.getElementById('accesoriosChart').getContext('2d');
            chartAccesorios = new Chart(ctxAccesorios, {
                type: 'bar',
                data: {
                    labels: accesoriosData.map(item => `${item.material} - ${item.tipo}`),
                    datasets: [{
                        label: 'Cantidad',
                        data: accesoriosData.map(item => item.cantidad),
                        backgroundColor: 'rgba(255, 99, 132, 0.2)',
                        borderColor: 'rgba(255, 99, 132, 1)',
                        borderWidth: 1
                    }]
                },
                options: {
                    indexAxis: 'y',  // Cambia a horizontal
                    scales: {
                        x: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Cantidad',
                                align: 'end'
                            }
                        },
                        y: {
                            title: {
                                display: true,
                                text: 'Material - Tipo',
                                align: 'end'
                            },
                            ticks: {
                                autoSkip: false  // Evita que las etiquetas se omitan automáticamente
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        }
                    }
                }
            });
        }

        function updateChartAccesorios() {
            chartAccesorios.data.labels = accesoriosData.map(item => `${item.material} - ${item.tipo}`);
            chartAccesorios.data.datasets[0].data = accesoriosData.map(item => item.cantidad);
            chartAccesorios.update();
        }

        // Cargar inicialmente
        function loadContent() {
            document.getElementById('dynamicContent').innerHTML = "";
            loadTuberia();
            loadAccesorios();
        }

        window.onload = loadContent; // Asegura que el contenido se cargue después de que el DOM esté listo
    

        // ---------------------------------------------------------------------------
        // Creacion Tabla de Proyectos add/edit/print/dowload/delete
        // ---------------------------------------------------------------------------

       // ---------------------------------------------------------------------------
        // Creacion Tabla de Proyectos add/edit/print/dowload/delete
        // ---------------------------------------------------------------------------

        // Constantes.
        const PROJECT_ID_PREFIX = 'OT-';
        const ADDITION_ID_PREFIX = 'AD-';
        let proyectosData = [];
        let proyectoEditandoId = null; // Variable para almacenar el ID del proyecto que se está editando

        // Campos editables para proyectos principales
        const MAIN_PROJECT_EDITABLE_FIELDS = ['descripcion', 'encargado', 'estado'];

        // Campos editables para adiciones
        const ADDITION_EDITABLE_FIELDS = ['Proyecto', 'descripcion', 'ubicacion', 'fechaInicio', 'fechaFin', 'encargado', 'estado', 'presupuesto'];

        // ---------------------------------------------------------------------------
        // Funciones de Utilidad
        // ---------------------------------------------------------------------------

        function generateId(prefix) {
            return prefix + Math.floor(Math.random() * 10000);
        }

        // ---------------------------------------------------------------------------
        // Funciones de Interfaz de Usuario (UI)
        // ---------------------------------------------------------------------------

        function renderTable() {
            const dynamicContent = document.getElementById('dynamicContent');
            const tableHeaders = `
                <tr>
                    <th></th> <!-- Columna para el icono del ojo -->
                    <th>ID</th>
                    <th>Proyecto</th>
                    <th>Descripción</th>
                    <th>Ubicación</th>
                    <th>Fecha de Inicio</th>
                    <th>Fecha de Fin</th>
                    <th>Encargado</th>
                    <th>Estado</th>
                    <th>Presupuesto</th>
                    <th>Acciones</th>
                </tr>
            `;

            function renderRow(proyecto) {
                let actionIcons = '';

                if (proyecto.isAddition) {
                    actionIcons = `
                        <i class="fas fa-edit edit-project" data-id="${proyecto.id}" title="Editar"></i>
                        <i class="fas fa-trash delete-project" data-id="${proyecto.id}" title="Eliminar"></i>
                    `;
                } else {
                    actionIcons = `
                        <i class="fas fa-edit edit-project" data-id="${proyecto.id}" title="Editar"></i>
                        <i class="fas fa-plus-square add-addition" data-id="${proyecto.id}" title="Adición"></i>
                        <i class="fas fa-file-pdf load-pdf" data-id="${proyecto.id}" title="Cargar PDF"></i>
                        <i class="fas fa-download download-project" data-id="${proyecto.id}" title="Descargar"></i>
                        <i class="fas fa-trash delete-project" data-id="${proyecto.id}" title="Eliminar"></i>
                    `;
                }

                // Determinar si la fila debe tener la clase "addition-row"
                const rowClass = proyecto.isAddition ? 'project-row addition-row' : 'project-row';

                // Agregar el icono del ojo si es el proyecto principal y tiene adiciones
                let eyeIcon = '';
                if (!proyecto.isAddition && proyectosData.some(p => p.parentId === proyecto.id)) {
                    eyeIcon = `<i class="fas fa-eye toggle-additions" data-project-id="${proyecto.id}" title="Mostrar/Ocultar Adiciones"></i>`;
                }

                return `
                    <tr class="${rowClass}" data-id="${proyecto.id}" data-parent-id="${proyecto.parentId || ''}">
                        <td class="eye-icon-cell">${eyeIcon}</td>
                        <td>${proyecto.id}</td>
                        <td>${proyecto.nombre}</td>
                        <td>${proyecto.descripcion}</td>
                        <td>${proyecto.ubicacion}</td>
                        <td>${proyecto.fechaInicio}</td>
                        <td>${proyecto.fechaFin}</td>
                        <td>${proyecto.encargado}</td>
                        <td>${proyecto.estado}</td>
                        <td>${proyecto.presupuesto}</td>
                        <td class="action-icons">
                            ${actionIcons}
                        </td>
                    </tr>
                `;
            }

            function renderProyectosRecursivamente(proyectos, parentId = null) {
                let html = '';
                const proyectosFiltrados = proyectos.filter(proyecto => proyecto.parentId === parentId);

                proyectosFiltrados.forEach(proyecto => {
                    html += renderRow(proyecto);
                    html += renderProyectosRecursivamente(proyectos, proyecto.id); // Llamada recursiva para las adiciones
                });

                return html;
            }

            dynamicContent.innerHTML = `
                <h2 class="vertical-title">Proyectos</h2>
                <div class="table-container">
                    <table>
                        <thead>${tableHeaders}</thead>
                        <tbody>${renderProyectosRecursivamente(proyectosData)}</tbody>
                    </table>
                    <button id="createProjectButton">Crear Proyecto</button>
                </div>
            `;
        }

        function assignEventListeners() {
            // **DELEGACIÓN DE EVENTOS**
            const tableBody = document.querySelector('#dynamicContent table tbody');
            if (tableBody) {
                tableBody.addEventListener('click', function(event) {
                    const target = event.target;
                    const projectId = target.dataset.id;

                    if (target.classList.contains('edit-project')) {
                        editProject(projectId);
                    } else if (target.classList.contains('add-addition')) {
                        addAddition(projectId);
                    } else if (target.classList.contains('load-pdf')) {
                        loadPDF(projectId);
                    } else if (target.classList.contains('download-project')) {
                        downloadProject(projectId);
                    } else if (target.classList.contains('delete-project')) {
                        proyectoEditandoId = projectId;
                        openConfirmModal();
                    }
                    // Delegación de evento para el toggle de adiciones
                    else if (target.classList.contains('toggle-additions')) {
                        const parentProjectId = target.dataset.projectId;
                        toggleAdditions(parentProjectId);
                    }
                });
            }
            // Crear proyecto
            document.getElementById('createProjectButton').addEventListener('click', createProject);

            // Cerrar modal con la "X"
            document.querySelector('.close').addEventListener('click', closeModal);

            // Evento para confirmar la eliminación
            document.getElementById('confirmDelete').addEventListener('click', () => {
                deleteProjectAndAdditions(proyectoEditandoId);
                closeConfirmModal();
                loadProyectos();
            });

            // Evento para cancelar la eliminación
            document.getElementById('cancelDelete').addEventListener('click', closeConfirmModal);
        }

        function toggleAdditions(projectId) {
            // Encuentra todas las filas de adición para el proyecto principal
            const additionRows = document.querySelectorAll(`.project-row[data-parent-id="${projectId}"]`);
            additionRows.forEach(row => {
                row.classList.toggle('show-additions'); // Cambia la visibilidad
            });
        }

        function loadProyectos() {
            renderTable();
            assignEventListeners();
        }

        // ---------------------------------------------------------------------------
        // Funciones Modales
        // ---------------------------------------------------------------------------

        function openModal(title) {
            document.getElementById('modalTitle').textContent = title;
            document.getElementById('projectModal').style.display = 'block';
        }

        function closeModal() {
            document.getElementById('projectModal').style.display = 'none';
            proyectoEditandoId = null; // Restablecer proyectoEditandoId al cerrar el modal
        }

        function openConfirmModal() {
            document.getElementById('confirmModal').style.display = 'block';
        }

        function closeConfirmModal() {
            document.getElementById('confirmModal').style.display = 'none';
        }

        // ---------------------------------------------------------------------------
        // Funciones de CRUD (Crear, Leer, Actualizar, Eliminar) - Proyectos
        // ---------------------------------------------------------------------------

        function createProject() {
            proyectoEditandoId = null;
            openModal("Crear Proyecto");
            const projectForm = document.getElementById('projectForm');
            projectForm.reset();

            const projectIdField = document.getElementById('projectId');
            projectIdField.value = generateId(PROJECT_ID_PREFIX);
            projectIdField.disabled = true; // Habilitar la edición del ID

            //Habilitar el resto de los campos
            document.getElementById('projectId').disabled = false;
            document.getElementById('projectName').disabled = false;
            document.getElementById('projectDescription').disabled = false;
            document.getElementById('projectLocation').disabled = false;
            document.getElementById('projectStartDate').disabled = false;
            document.getElementById('projectEndDate').disabled = false;
            document.getElementById('projectManager').disabled = false;
            document.getElementById('projectStatus').disabled = false;
            document.getElementById('projectBudget').disabled = false;

            projectForm.dataset.mode = 'create'; // Indica que estamos en modo de creación
        }

        function editProject(projectId) {
            proyectoEditandoId = projectId; //SETEAR EL ID DEL PROYECTO A EDITAR
            const proyecto = proyectosData.find(p => p.id === projectId);

            if (!proyecto) {
                console.error(`Proyecto con ID ${projectId} no encontrado`);
                return;
            }

            openModal("Editar Proyecto");
            const projectForm = document.getElementById('projectForm');

            document.getElementById('projectId').value = proyecto.id;
            document.getElementById('projectName').value = proyecto.nombre;
            document.getElementById('projectDescription').value = proyecto.descripcion;
            document.getElementById('projectLocation').value = proyecto.ubicacion;
            document.getElementById('projectStartDate').value = proyecto.fechaInicio;
            document.getElementById('projectEndDate').value = proyecto.fechaFin;
            document.getElementById('projectManager').value = proyecto.encargado;
            document.getElementById('projectStatus').value = proyecto.estado;
            document.getElementById('projectBudget').value = proyecto.presupuesto;

            // Deshabilitar campos no editables
            document.getElementById('projectId').disabled = true;
            document.getElementById('projectName').disabled = true;
            document.getElementById('projectLocation').disabled = true;
            document.getElementById('projectStartDate').disabled = true;
            document.getElementById('projectEndDate').disabled = true;
            document.getElementById('projectBudget').disabled = true;

            // Habilitar solo los campos editables
            document.getElementById('projectDescription').disabled = false;
            document.getElementById('projectManager').disabled = false;
            document.getElementById('projectStatus').disabled = false;

            // Establecer el modo del formulario
            projectForm.dataset.mode = 'edit';
        }

        function addAddition(projectId) {
            proyectoEditandoId = null;
            openModal("Adición a Proyecto");

            const projectForm = document.getElementById('projectForm');
            projectForm.reset();
            const projectIdField = document.getElementById('projectId');

            const newId = generateId(PROJECT_ID_PREFIX); // Genera ID con OT-
            projectIdField.value = newId;
            projectIdField.dataset.parentId = projectId; // Almacena el ID del padre
            projectIdField.disabled = false; // Habilitar la edición del ID

            // Habilitar todos los campos
            document.getElementById('projectName').disabled = false;
            document.getElementById('projectDescription').disabled = false;
            document.getElementById('projectLocation').disabled = false;
            document.getElementById('projectStartDate').disabled = false;
            document.getElementById('projectEndDate').disabled = false;
            document.getElementById('projectManager').disabled = false;
            document.getElementById('projectStatus').disabled = false;
            document.getElementById('projectBudget').disabled = false;

            // Establecer el modo del formulario
            projectForm.dataset.mode = 'add';
        }

        function saveProject(event) {
            event.preventDefault();

            const projectForm = document.getElementById('projectForm');

            const projectData = {
                id: document.getElementById('projectId').value,
                nombre: document.getElementById('projectName').value,
                descripcion: document.getElementById('projectDescription').value,
                ubicacion: document.getElementById('projectLocation').value,
                fechaInicio: document.getElementById('projectStartDate').value,
                fechaFin: document.getElementById('projectEndDate').value,
                encargado: document.getElementById('projectManager').value,
                estado: document.getElementById('projectStatus').value,
                presupuesto: document.getElementById('projectBudget').value,
                parentId: document.getElementById('projectId').dataset.parentId || null,
                isAddition: projectForm.dataset.mode === 'add'
            };
            const index = proyectosData.findIndex(p => p.id === proyectoEditandoId);

            if (index !== -1) {
                const existingProject = proyectosData[index];

                // Update only the allowed fields
                if (existingProject.isAddition) {
                    ADDITION_EDITABLE_FIELDS.forEach(field => {
                        existingProject[field] = projectData[field];
                    });
                } else {
                    MAIN_PROJECT_EDITABLE_FIELDS.forEach(field => {
                        existingProject[field] = projectData[field];
                    });
                }

                proyectosData[index] = { ...existingProject }; // Use the updated existing project
            } else {
                // Creating a new project or addition
                proyectosData.push(projectData);
            }

            closeModal();
            loadProyectos();

            // Restablecer proyectoEditandoId a null después de guardar
            proyectoEditandoId = null;
        }

        function deleteProjectAndAdditions(projectId) {
            // Eliminar el proyecto actual
            proyectosData = proyectosData.filter(p => p.id !== projectId);

            // Encontrar y eliminar adiciones del proyecto (recursivamente)
            const additionsToDelete = proyectosData.filter(p => p.parentId === projectId).map(p => p.id);
            additionsToDelete.forEach(addId => deleteProjectAndAdditions(addId));
        }

        // ---------------------------------------------------------------------------
        // Funciones de  Descargar
        // ---------------------------------------------------------------------------
        
        function loadPDF(projectId) {
            const proyecto = proyectosData.find(p => p.id === projectId);
            if (proyecto) {
                // Crear un input de tipo file dinámicamente
                const input = document.createElement('input');
                input.type = 'file';
                input.accept = 'application/pdf'; // Aceptar solo archivos PDF
        
                // Simular un clic en el input para abrir el diálogo de selección de archivos
                input.click();
        
                // Listener para el evento 'change' del input
                input.addEventListener('change', function(event) {
                    const file = event.target.files[0]; // Obtener el archivo seleccionado
        
                    if (file) {
                        // Aquí puedes realizar acciones con el archivo PDF, como subirlo a un servidor,
                        // previsualizarlo, etc.
                        console.log('Archivo PDF seleccionado:', file.name);
                        console.log('Tamaño del archivo:', file.size, 'bytes');
                        console.log('Tipo de archivo:', file.type);
        
                        // Ejemplo de cómo podrías leer el contenido del archivo (opcional):
                        const reader = new FileReader();
                        reader.onload = function(e) {
                            // e.target.result contiene el contenido del archivo como un Data URL
                            // console.log('Contenido del archivo:', e.target.result);
                            // Puedes usar este Data URL para previsualizar el PDF en un iframe o canvas
                        }
                        reader.readAsDataURL(file); // Lee el archivo como Data URL
        
                        // TODO: Implementar la lógica para guardar la referencia al archivo PDF
                        //       (por ejemplo, guardar la URL en la propiedad del proyecto)
                        // proyecto.pdfUrl = 'URL_DEL_ARCHIVO_SUBIDO';
                    }
                });
            }
        }

        function downloadProject(projectId) {
            const proyecto = proyectosData.find(p => p.id === projectId);
            if (proyecto) {
                const blob = new Blob([JSON.stringify(proyecto, null, 2)], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `proyecto_${proyecto.id}.json`;
                a.click();
                URL.revokeObjectURL(url);
            }
        }

        // ---------------------------------------------------------------------------
        // Inicialización
        // ---------------------------------------------------------------------------

        // Cargar proyectos al hacer clic en el enlace
        document.getElementById('proyectosLink').addEventListener('click', function(event) {
            event.preventDefault();
            loadProyectos();
        });

        // Evento para el formulario de proyecto (guardar)
        document.getElementById('projectForm').addEventListener('submit', saveProject);

        // Carga inicial de proyectos
        loadProyectos();
        

        // Datos de ejemplo para Requisición
        const requisicionData = [
            {
                item: 1,
                descripcion: "Codo de cobre de 1/2\"",
                unidad: "UND",
                cantidadSolicitada: 20,
                cantidadEntregada: 15,
                cantidadPendiente: 5
            },
            {
                item: 2,
                descripcion: "Tee de cobre de 3/4\"",
                unidad: "UND",
                cantidadSolicitada: 10,
                cantidadEntregada: 10,
                cantidadPendiente: 0
            },
            {
                item: 3,
                descripcion: "Reductor de cobre de 1\" a 1/2\"",
                unidad: "UND",
                cantidadSolicitada: 5,
                cantidadEntregada: 3,
                cantidadPendiente: 2
            },
            {
                item: 4,
                descripcion: "Tubo de cobre de 1/2\" (3 metros)",
                unidad: "MTS",
                cantidadSolicitada: 2,
                cantidadEntregada: 2,
                cantidadPendiente: 0
            },
            {
                item: 5,
                descripcion: "Soldadura de plata",
                unidad: "GR",
                cantidadSolicitada: 50,
                cantidadEntregada: 50,
                cantidadPendiente: 0
            },
            {
                item: 6,
                descripcion: "Lija para cobre",
                unidad: "UND",
                cantidadSolicitada: 10,
                cantidadEntregada: 8,
                cantidadPendiente: 2
            },
            {
                item: 7,
                descripcion: "Cinta de teflón",
                unidad: "UND",
                cantidadSolicitada: 5,
                cantidadEntregada: 5,
                cantidadPendiente: 0
            },
            {
                item: 8,
                descripcion: "Brocha de 1\"",
                unidad: "UND",
                cantidadSolicitada: 2,
                cantidadEntregada: 2,
                cantidadPendiente: 0
            },
            {
                item: 9,
                descripcion: "Pintura anticorrosiva",
                unidad: "GLN",
                cantidadSolicitada: 1,
                cantidadEntregada: 1,
                cantidadPendiente: 0
            },
            {
                item: 10,
                descripcion: "Thinner",
                unidad: "LT",
                cantidadSolicitada: 1,
                cantidadEntregada: 1,
                cantidadPendiente: 0
            }
        ];

        // Función para cargar la requisición y poblar la tabla
        function loadRequisicion() {
            const requisicionForm = `

        <style>
            body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 20px;
            background-color: #f4f4f4;
            color: #333;
        }

        h2 {
            text-align: center;
            margin-bottom: 20px;
            font-size: 20px; /* Tamaño de fuente reducido */
            color: #2c3e50;
        }

        p {
            text-align: center;
            margin: 5px 0;
            font-size: 14px; /* Tamaño de fuente reducido */
            color: #7f8c8d;
        }

        form {
            width: 95%;
            max-width: 1200px;
            margin: 0 auto;
            background-color: #fff;
            padding: 15px; /* Padding reducido */
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        label {
            display: block;
            margin-bottom: 5px;
            font-size: 14px; /* Tamaño de fuente reducido */
            font-weight: bold;
            color: #34495e;
        }

        input[type="text"],
        input[type="number"],
        input[type="date"],
        textarea {
            width: calc(100% - 18px);
            padding: 6px; /* Padding reducido */
            margin-bottom: 8px; /* Margen reducido */
            border: 1px solid #bdc3c7;
            border-radius: 4px;
            font-size: 12px; /* Tamaño de fuente reducido */
            box-sizing: border-box;
        }

        input[type="text"]:focus,
        input[type="number"]:focus,
        input[type="date"]:focus,
        textarea:focus {
            border-color: #2c3e50;
            outline: none;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 15px; /* Margen reducido */
            background-color: #fff;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            table-layout: fixed;
        }

        th, td {
            border: 1px solid #bdc3c7;
            padding: 8px; /* Padding reducido */
            text-align: center;
            font-size: 12px; /* Tamaño de fuente reducido */
            word-break: break-word;
        }

        th {
            background-color: #2c3e50;
            color: #fff;
            font-weight: bold;
        }

        input[readonly] {
            background-color: #ecf0f1;
            cursor: not-allowed;
        }

        button {
            display: inline-block;
            padding: 8px 16px; /* Padding reducido */
            background-color: #2c3e50;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px; /* Tamaño de fuente reducido */
            transition: background-color 0.3s ease;
            white-space: nowrap;
        }

        button:hover {
            background-color: #233140;
        }

        /* Estilos específicos para la tabla */
        table input {
            width: calc(100% - 10px);
            margin: 0 auto;
            text-align: center;
            border: 1px solid #bdc3c7;
            border-radius: 4px;
            padding: 4px; /* Padding reducido */
            font-size: 12px; /* Tamaño de fuente reducido */
            box-sizing: border-box;
        }

        table input[type="number"] {
            width: calc(90% - 10px);
        }

        table input[readonly] {
            background-color: #ecf0f1;
        }

        /* Estilos para las observaciones y firmas */
        textarea {
            width: calc(100% - 18px);
            height: 80px; /* Altura reducida */
            margin-bottom: 15px; /* Margen reducido */
            border: 1px solid #bdc3c7;
            border-radius: 4px;
            padding: 6px; /* Padding reducido */
            font-size: 12px; /* Tamaño de fuente reducido */
            box-sizing: border-box;
        }

        /* Estilos para las firmas y cargos */
        .firma {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-between;
            margin-bottom: 15px; /* Margen reducido */
        }

        .firma div {
            width: 48%;
            box-sizing: border-box;
            padding: 0 8px; /* Padding reducido */
        }

        .firma label {
            display: block;
            margin-bottom: 4px; /* Margen reducido */
            font-size: 14px; /* Tamaño de fuente reducido */
            color: #34495e;
        }

        .firma input {
            width: calc(100% - 18px);
            padding: 6px; /* Padding reducido */
            margin-bottom: 8px; /* Margen reducido */
            border: 1px solid #bdc3c7;
            border-radius: 4px;
            font-size: 12px; /* Tamaño de fuente reducido */
            box-sizing: border-box;
        }

        /* Media Queries para Responsive Design */
        @media (max-width: 768px) {
            form {
                width: 90%;
                padding: 10px; /* Padding reducido */
            }

            .firma div {
                width: 100%;
                margin-bottom: 8px; /* Margen reducido */
                padding: 0;
            }

            table {
                table-layout: auto;
                border-collapse: collapse;
                margin-bottom: 10px; /* Margen reducido */
            }

            th, td {
                padding: 6px; /* Padding reducido */
                font-size: 12px; /* Tamaño de fuente reducido */
            }

            table input {
                font-size: 12px; /* Tamaño de fuente reducido */
                padding: 4px; /* Padding reducido */
            }

            button {
                display: inline-block;
                padding: 6px 12px; /* Padding reducido */
                background-color: #2c3e50;
                color: white;
                border: none;
                border-radius: 4px;
                cursor: pointer;
                font-size: 12px; /* Tamaño de fuente reducido */
                transition: background-color 0.3s ease;
                white-space: nowrap;
            }
        }
        </style>

                <h2>SISTEMA INTEGRADO DE GESTION</h2>
                <p>CÓDIGO: CP-RQ-01</p>
                <p>FECHA: 2024-03-20</p>
                <p>VERSIÓN: 1</p>
                <p>PÁGINA: 1 DE 1</p>

                <form>
                    <label for="solicitante">SOLICITA:</label>
                    <input type="text" id="solicitante" name="solicitante" value="NICOLAS SAAVEDRA"><br><br>
                    </form>
                    
                    <table>
                        <thead>
                            <tr>
                                <th>ITEM</th>
                                <th>DESCRIPCION</th>
                                <th>UNIDAD</th>
                                <th>FECHA DE NECESIDAD</th>
                                <th>CANTIDAD SOLICITADA</th>
                                <th>VALOR UNITARIO</th>
                                <th>CANTIDAD ENTREGADA POR ALMACEN</th>
                                <th>VALOR ENTREGADA POR ALMACEN</th>
                                <th>CANTIDAD PENDIENTE</th>
                                <th>CANTIDAD ENTREGADA POR COMPRAS</th>
                                <th>VALOR ENTREGADA POR COMPRAS</th>
                                <th>DEVOLUCIÓN DEL PROYECTO</th>
                                <th>VALOR DEVOLUCIÓN DEL PROYECTO</th>
                            </tr>
                        </thead>
                        <tbody></tbody> </table>
                        <form>
                    <h3>OBSERVACIONES / RELACIÓN DE ANEXOS:</h3>
                    <textarea rows="4" cols="50"></textarea><br><br>

                    <label for="solicito">Solicitó:</label>
                    <input type="text" id="solicito" name="solicito" value="JAVIER SIERRA"><br><br>

                    <label for="aprobo">Aprobó:</label>
                    <input type="text" id="aprobo" name="aprobo" value="MELISSA GONZALES"><br><br>

                    <button type="submit">Enviar</button>
                    <button type="submit">Exportar Excel</button>
                </form>
            `;

            document.getElementById('dynamicContent').innerHTML = requisicionForm;

            const tbody = document.querySelector('tbody');

            requisicionData.forEach(item => {
                const row = tbody.insertRow();
                row.insertCell().textContent = item.item;
                row.insertCell().innerHTML = `<input type="text" value="${item.descripcion}">`;
                row.insertCell().innerHTML = `<input type="text" value="${item.unidad}">`;
                row.insertCell().innerHTML = `<input type="date">`;
                row.insertCell().innerHTML = `<input type="number" value="${item.cantidadSolicitada}" onchange="calcularPendiente(this)">`;
                row.insertCell().innerHTML = `<input type="number">`;
                row.insertCell().innerHTML = `<input type="number" value="${item.cantidadEntregada}" onchange="calcularPendiente(this)">`;
                row.insertCell().innerHTML = `<input type="number">`;
                row.insertCell().innerHTML = `<input type="number" value="${item.cantidadPendiente}" readonly>`;
                row.insertCell().innerHTML = `<input type="number" value="0" onchange="calcularPendiente(this)">`;
                row.insertCell().innerHTML = `<input type="number">`;
                row.insertCell().innerHTML = `<input type="number">`;
                row.insertCell().innerHTML = `<input type="number" value="0" readonly>`;
            });
        }


        function calcularPendiente(input) {
            const row = input.parentNode.parentNode;
            const cantidadSolicitada = parseFloat(row.cells[4].querySelector('input').value) || 0;
            const cantidadEntregadaAlmacen = parseFloat(row.cells[6].querySelector('input').value) || 0;
            const cantidadEntregadaCompras = parseFloat(row.cells[9].querySelector('input').value) || 0;
            const cantidadPendiente = cantidadSolicitada - (cantidadEntregadaAlmacen + cantidadEntregadaCompras);
            row.cells[8].querySelector('input').value = cantidadPendiente;
        }

        // Asignar evento al enlace de Requisición
        document.getElementById('requisicionLink').addEventListener('click', function (event) {
            event.preventDefault();
            clearDynamicContent();
            loadRequisicion();
        });

        // Datos de ejemplo para Proveedores
        const proveedoresData = [
            { nombre: "Proveedor A", contacto: "contacto@proveedora.com", telefono: "+123456789" },
            { nombre: "Proveedor B", contacto: "contacto@proveedorb.com", telefono: "+987654321" },
            { nombre: "Proveedor C", contacto: "contacto@proveedorc.com", telefono: "+1122334455" }
        ];

        // Función para cargar la tabla de Proveedores
        function loadProveedores() {
            const tableHeaders = `
                <tr>
                    <th>Nombre</th>
                    <th>Contacto</th>
                    <th>Teléfono</th>
                </tr>
            `;

            const tableRows = proveedoresData.map(item => `
                <tr>
                    <td>${item.nombre}</td>
                    <td>${item.contacto}</td>
                    <td>${item.telefono}</td>
                </tr>
            `).join('');

            const tableContent = `
                <h2>Proveedores</h2>
                <div class="table-container">
                    <table>
                        <thead>${tableHeaders}</thead>
                        <tbody>${tableRows}</tbody>
                    </table>
                </div>
            `;

            document.getElementById('dynamicContent').innerHTML = tableContent;
        }

        document.getElementById('proveedoresLink').addEventListener('click', function (event) {
            event.preventDefault();
            clearDynamicContent();
            loadProveedores();
        });


        // ALMACEN ....... Datos de ejemplo para Almacenes (temporal - luego vendrá de Django)

        // Datos de almacenes (simulados)
const almacenData = {
  bogota: {
    id: "BOG001",
    nombre: "Almacén Bogotá",
    ubicacion: "Calle 12b Sur 52 A 77, Bogotá",
    encargado: "Carolina Pérez",
    contacto: "ingegasesyredes@gmail.com",
    productos: []
  },
  cali: {
    id: "CAL001",
    nombre: "Almacén Cali",
    ubicacion: "Avenida Siempre Viva 456, Cali",
    encargado: "Carlos Lopez",
    contacto: "carlos.lopez@almacencali.com",
    productos: []
  }
};

// Cargar pantalla principal
function loadPantallaPrincipal() {
  const principalHTML = `
    <div class="alm-cards-view">
      <div class="alm-header-section">
        <h1 class="alm-main-title">
          <i class="fas fa-warehouse"></i> Gestión de Almacenes
        </h1>
        <p class="alm-subtitle">Seleccione un almacén para ver su inventario</p>
      </div>
      
      <div class="alm-card-container">
        <div class="alm-card alm-card-bogota" onclick="openAlmacenModal('BOG001')">
          <div class="alm-card-icon">
            <i class="fas fa-building"></i>
          </div>
          <h3 class="alm-card-title">Almacén Bogotá</h3>
          <div class="alm-card-details">
            <p><i class="fas fa-map-marker-alt"></i> ${almacenData.bogota.ubicacion}</p>
            <p><i class="fas fa-user-tie"></i> ${almacenData.bogota.encargado}</p>
          </div>
          <div class="alm-card-footer">
            <span class="alm-badge">${almacenData.bogota.productos.length} productos</span>
          </div>
        </div>
        
        <div class="alm-card alm-card-cali" onclick="openAlmacenModal('CAL001')">
          <div class="alm-card-icon">
            <i class="fas fa-building"></i>
          </div>
          <h3 class="alm-card-title">Almacén Cali</h3>
          <div class="alm-card-details">
            <p><i class="fas fa-map-marker-alt"></i> ${almacenData.cali.ubicacion}</p>
            <p><i class="fas fa-user-tie"></i> ${almacenData.cali.encargado}</p>
          </div>
          <div class="alm-card-footer">
            <span class="alm-badge">${almacenData.cali.productos.length} productos</span>
          </div>
        </div>
      </div>
    </div>
  `;
  
  document.getElementById('dynamicContent').innerHTML = principalHTML;
}

// Abrir modal de almacén
function openAlmacenModal(almacenId) {
  const modal = document.getElementById('almacenModal');
  const modalBody = document.getElementById('almacenModalBody');
  
  const almacen = Object.values(almacenData).find(a => a.id === almacenId);
  if (!almacen) return;
  
  modalBody.innerHTML = generarContenidoModal(almacen);
  modal.classList.add('show');
  document.body.classList.add('alm-modal-open');
}

// Generar contenido del modal
function generarContenidoModal(almacen) {
  return `
    <div class="alm-modal-section">
      <div class="alm-info-header">
        <div class="alm-info-icon">
          <i class="fas fa-warehouse"></i>
        </div>
        <div>
          <h3 class="alm-section-title">${almacen.nombre}</h3>
          <p class="alm-info-subtitle">${almacen.ubicacion}</p>
        </div>
      </div>
      
      <div class="alm-info-grid">
        <div class="alm-info-card">
          <i class="fas fa-user-tie alm-info-card-icon"></i>
          <h4>Encargado</h4>
          <p>${almacen.encargado}</p>
        </div>
        <div class="alm-info-card">
          <i class="fas fa-envelope alm-info-card-icon"></i>
          <h4>Contacto</h4>
          <p><a href="mailto:${almacen.contacto}">${almacen.contacto}</a></p>
        </div>
      </div>
    </div>
    
    <div class="alm-modal-section">
      <div class="alm-section-header">
        <h3 class="alm-section-title">
          <i class="fas fa-boxes"></i> Inventario
        </h3>
        <button class="alm-btn alm-btn-primary" onclick="abrirModalAgregarProducto('${almacen.id}')">
          <i class="fas fa-plus"></i> Agregar Producto
        </button>
      </div>
      
      ${generarTablaInventario(almacen.productos, almacen.id)}
    </div>
  `;
}

// Generar tabla de inventario
function generarTablaInventario(productos, almacenId) {
  if (productos.length === 0) {
    return `
      <div class="alm-empty-state">
        <div class="alm-empty-icon">
          <i class="fas fa-box-open"></i>
        </div>
        <h4>No hay productos registrados</h4>
        <p>Agregue productos para comenzar a gestionar el inventario</p>
        <button class="alm-btn alm-btn-primary" onclick="abrirModalAgregarProducto('${almacenId}')">
          <i class="fas fa-plus"></i> Agregar primer producto
        </button>
      </div>
    `;
  }
  
  return `
    <div class="alm-table-responsive">
      <table class="alm-table">
        <thead>
          <tr>
            <th>Código</th>
            <th>Descripción</th>
            <th>Cantidad</th>
            <th>Acciones</th>
          </tr>
        </thead>
        <tbody>
          ${productos.map((producto, index) => `
            <tr>
              <td>${producto.codigo}</td>
              <td>${producto.descripcion}</td>
              <td>
                <div class="alm-quantity-control">
                  <span class="alm-quantity-value">${producto.cantidad}</span>
                  <div class="alm-quantity-buttons">
                    <button class="alm-btn alm-btn-sm alm-btn-success" 
                            onclick="modificarCantidad('${almacenId}', ${index}, 1)">
                      <i class="fas fa-plus"></i>
                    </button>
                    <button class="alm-btn alm-btn-sm alm-btn-warning" 
                            onclick="modificarCantidad('${almacenId}', ${index}, -1)">
                      <i class="fas fa-minus"></i>
                    </button>
                  </div>
                </div>
              </td>
              <td class="alm-actions">
                <button class="alm-btn alm-btn-danger alm-btn-sm" 
                        onclick="eliminarProducto('${almacenId}', ${index})">
                  <i class="fas fa-trash"></i>
                </button>
              </td>
            </tr>
          `).join('')}
        </tbody>
      </table>
    </div>
    
    <div class="alm-inventory-summary">
      <div class="alm-summary-item">
        <span>Total productos:</span>
        <strong>${productos.length}</strong>
      </div>
      <div class="alm-summary-item">
        <span>Total unidades:</span>
        <strong>${productos.reduce((sum, p) => sum + p.cantidad, 0)}</strong>
      </div>
    </div>
  `;
}

// Abrir modal para agregar producto
function abrirModalAgregarProducto(almacenId) {
  const modal = document.getElementById('agregarProductoModal');
  const form = document.getElementById('alm-productoForm');
  
  form.innerHTML = `
    <div class="alm-form-group">
      <label class="alm-form-label">Material *</label>
      <select class="alm-form-input" id="productoMaterial" required>
        <option value="">Seleccione material...</option>
        <option value="PVC">PVC</option>
        <option value="Acero">Acero</option>
        <option value="Cobre">Cobre</option>
        <option value="Galvanizado">Galvanizado</option>
        <option value="Hierro">Hierro</option>
      </select>
    </div>
    
    <div class="alm-form-group">
      <label class="alm-form-label">Tipo *</label>
      <select class="alm-form-input" id="productoTipo" required>
        <option value="">Seleccione tipo...</option>
        <option value="Tubo">Tubo</option>
        <option value="Válvula">Válvula</option>
        <option value="Codo">Codo</option>
        <option value="Reducción">Reducción</option>
        <option value="Accesorio">Accesorio</option>
      </select>
    </div>
    
    <div class="alm-form-group">
      <label class="alm-form-label">Diámetro/Medida *</label>
      <input type="text" class="alm-form-input" id="productoDiametro" required>
    </div>
    
    <div class="alm-form-group">
      <label class="alm-form-label">Cantidad *</label>
      <input type="number" class="alm-form-input" id="productoCantidad" min="1" value="1" required>
    </div>
    
    <input type="hidden" id="almacenId" value="${almacenId}">
  `;
  
  modal.classList.add('show');
  document.body.classList.add('alm-modal-open');
}

// Guardar nuevo producto
function guardarNuevoProducto() {
  const form = document.getElementById('alm-productoForm');
  if (!form.reportValidity()) return;
  
  const material = document.getElementById('productoMaterial').value;
  const tipo = document.getElementById('productoTipo').value;
  const diametro = document.getElementById('productoDiametro').value;
  const cantidad = parseInt(document.getElementById('productoCantidad').value);
  const almacenId = document.getElementById('almacenId').value;
  
  // Generar código automático
  const codigo = `${material.substring(0, 3).toUpperCase()}-${tipo.substring(0, 3).toUpperCase()}-${Math.floor(100 + Math.random() * 900)}`;
  const descripcion = `${tipo} ${material} ${diametro}`;
  
  const almacenKey = Object.keys(almacenData).find(key => almacenData[key].id === almacenId);
  almacenData[almacenKey].productos.push({
    codigo, material, tipo, diametro, descripcion, cantidad
  });
  
  // Mostrar notificación
  mostrarNotificacion('success', 'Producto agregado', `El producto ${codigo} se ha agregado correctamente.`);
  
  // Cerrar modal y actualizar vista
  closeAlmModal('agregarProductoModal');
  const modalBody = document.getElementById('almacenModalBody');
  modalBody.innerHTML = generarContenidoModal(almacenData[almacenKey]);
}

// Modificar cantidad de producto
function modificarCantidad(almacenId, productoIndex, cambio) {
  const almacenKey = Object.keys(almacenData).find(key => almacenData[key].id === almacenId);
  const producto = almacenData[almacenKey].productos[productoIndex];
  
  const nuevaCantidad = producto.cantidad + cambio;
  if (nuevaCantidad < 0) {
    mostrarNotificacion('error', 'Error', 'La cantidad no puede ser menor a cero');
    return;
  }
  
  producto.cantidad = nuevaCantidad;
  
  // Actualizar vista
  const quantityElements = document.querySelectorAll('.alm-quantity-value');
  if (quantityElements[productoIndex]) {
    quantityElements[productoIndex].textContent = nuevaCantidad;
  }
  
  mostrarNotificacion('success', 'Cantidad actualizada', `Cantidad de ${producto.codigo} actualizada a ${nuevaCantidad}`);
}

// Eliminar producto
function eliminarProducto(almacenId, productoIndex) {
  if (!confirm('¿Está seguro que desea eliminar este producto?')) return;
  
  const almacenKey = Object.keys(almacenData).find(key => almacenData[key].id === almacenId);
  const producto = almacenData[almacenKey].productos[productoIndex];
  
  almacenData[almacenKey].productos.splice(productoIndex, 1);
  
  // Actualizar vista
  const modalBody = document.getElementById('almacenModalBody');
  modalBody.innerHTML = generarContenidoModal(almacenData[almacenKey]);
  
  mostrarNotificacion('success', 'Producto eliminado', `El producto ${producto.codigo} ha sido eliminado`);
}

// Exportar inventario
function exportarInventario() {
  // Simulación de exportación
  mostrarNotificacion('info', 'Exportar inventario', 'Preparando archivo para descarga...');
  setTimeout(() => {
    mostrarNotificacion('success', 'Exportación completa', 'El inventario se ha exportado correctamente');
  }, 1500);
}

// Mostrar notificación
function mostrarNotificacion(tipo, titulo, mensaje) {
  const notificacion = document.createElement('div');
  notificacion.className = `alm-notification alm-notification-${tipo}`;
  notificacion.innerHTML = `
    <div class="alm-notification-icon">
      <i class="fas fa-${tipo === 'success' ? 'check-circle' : tipo === 'error' ? 'exclamation-circle' : 'info-circle'}"></i>
    </div>
    <div class="alm-notification-content">
      <h4>${titulo}</h4>
      <p>${mensaje}</p>
    </div>
    <button class="alm-notification-close" onclick="this.parentElement.remove()">
      <i class="fas fa-times"></i>
    </button>
  `;
  
  document.body.appendChild(notificacion);
  setTimeout(() => notificacion.remove(), 5000);
}

// Cerrar modal
function closeAlmModal(modalId) {
  const modal = document.getElementById(modalId);
  modal.classList.remove('show');
  document.body.classList.remove('alm-modal-open');
}

// Inicialización
document.addEventListener('DOMContentLoaded', () => {
  const almacenLink = document.getElementById('almacenLink');
  if (almacenLink) {
    almacenLink.addEventListener('click', (e) => {
      e.preventDefault();
      loadPantallaPrincipal();
    });
  }
  
  loadPantallaPrincipal();
});





        // Función para cargar la sección de Soporte
        function loadSoporte() {
            const soporteContent = `
                <h2>Soporte</h2>
                <div class="soporte-container">
                    <p>Para soporte técnico, contáctanos a través de:</p>
                    <ul>
                        <li>
                            <a href="https://wa.me/1234567890" target="_blank">
                                <i class="fab fa-whatsapp"></i> WhatsApp
                            </a>
                        </li>
                        <li>
                            <a href="mailto:davidalejandro.rx@live.com">
                                <i class="fas fa-envelope"></i> davidalejandro.rx@live.com
                            </a>
                        </li>
                    </ul>
                </div>
            `;

            document.getElementById('dynamicContent').innerHTML = soporteContent;
        }

        document.getElementById('soporteLink').addEventListener('click', function (event) {
            event.preventDefault();
            clearDynamicContent();
            loadSoporte();
        });

        // Función para limpiar el contenido dinámico
        function clearDynamicContent() {
            document.getElementById('dynamicContent').innerHTML = '';
        }

    </script>


</body>

</html>